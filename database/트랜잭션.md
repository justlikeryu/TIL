# 트랜잭션이란?
> DB에서 하나의 논리적 기능을 수행하는 작업의 기본 단위

## 트랜잭션의 상태 변화
활동 - 부분완료 - 완료 - 실패 - 철회

## 특성
- **원자성**: 트랜잭션의 연산 전체가 모두 성공하거나 실패하는 성질 e.g., 커밋, 롤백, 회복성 보장
- **일관성**: 시스템의 고정요소는 트랜잭션 수행 전후와 상관없이 상태가 같은 성질 e.g., 무결성 제약조건, 동시성 제어
- **고립성**: 동시에 실행되는 트랜잭션은 서로 영향을 미치지 않는 성질 e.g., Read Uncommitted, Read Committed, Repeatable Read, Serializable Read
- **영속성**: 성공한 트랜잭션의 결과는 영속적으로 DB에 저장되는 성질 e.g., 회복기법

## 트랜잭션 제어 언어(TCL)
- **커밋**: 트랜잭션을 메모리에 저장하는 명령어
- **롤백**: 트랜잭션 내역을 저장 무효화하는 명령어
- **체크포인트**: 롤백을 위한 시점을 지정하는 명령어

## 병행 제어
> 여러 트랜잭션을 수행할 때 DB 일관성 유지를 위해 상호 작용을 제어하는 기법
- 목적
    - DB 공유 최대화
    - DB 일관성 유지
    - 시스템 활용도 최대화
    - 사용자에 대한 응답시간 최소화
- 종류
    - **로킹**: 트랜잭션을 실행하는 동안 다른 트랜잭션이 다른 데이터에 접근할 수 없도록 상호배제 기능을 제공하는 기법
    - **낙관적 검증**: 트랜잭션을 수행한 후 검증하여 DB에 반영하는 기법
    - **타임스탬프 순서**: 트랜잭션을 수행하기 전 타임스탬프를 부여하여 이에 따라 트랜잭션을 수행하는 기법
    - **다중버전 동시성 제어**: 트랜잭션의 타임스탬프와 접근하려는 데이터의 타임스탬프를 비교해 직렬가능성이 보장되는 적절한 버전을 선택하여 접근하는 기법
- 병행 제어 미보장 시 문제점
  - **갱신 손실**: 먼저 실행된 트랜잭션 결과를 이후에 실행된 트랜잭션이 덮어쓸 때 발생하는 오류
  - **현황 파악오류**: 트랜잭션 중간 수행 결과를 다른 트랜잭션이 참조하여 발생하는 오류
  - **모순성**: 두 트랜잭션이 동시에 실행되어 DB 일관성이 결여되는 오류
  - **연쇄복귀**: 복수위 트랜잭션이 데이터를 공유하다 특정 트랜잭션이 처리를 취소할 경우 해당 트랜잭션이 처리한 부분을 취소하지 못하는 오류

## DB 고립화 수준
> 다른 트랜잭션이 현재 데이터의 무결성을 해치지 않게 잠금을 설정하는 정도
- 종류
  - **Read Uncommited**: 연산 중인 데이터에 대한 연산을 할 수 없다.
  - **Read Commited**: 연산이 완료된 데이터는 읽을 수 있다.
  - **Repeatable Read**: 선행 트랜잭션이 데이터를 읽오 있는 동안 해당 데이터에 대한 갱신 및 삭제는 할 수 없다.
  - **Serializable Read**: 선행 트랜잭션이 데이터를 읽는 동안 해당 데이터 영역 전체에 대한 접근을 제한한다.

## 회복 기법
> 트랜잭션 수행 중 손상된 DB를 손상되기 전으로 복구하는 작업
- 주요 요소
  - **REDO**: 트랜잭션의 시작과 완료(Commit) 기록이 있는 트랜잭션 작업을 재작업하는 기법
  - **UNDO**: 트랜잭션의 시작은 있지만 완료(Commit) 기록이 없는 트랜잭션 작업이 작업한 변경 내용을 모두 취소하는 기법
- 종류
  - **로그 기반 회복 기법** e.g., 지연 갱신 회복 기법, 즉각 갱신 회복 기법
  - **체크 포인트 회복 기법**
  - **그림자 페이징 회복 기법**